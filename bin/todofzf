#!/bin/bash

args="${*:-show}"

if command -v todo >/dev/null; then
    launch='todo'
else
    launch='todoman'
fi

eval " ${launch} --color=always list" | fzf --ansi \
    --bind="enter:become(${launch} show {3} | glow)" \
    --bind="ctrl-t:execute(${launch} done {3})" \
    --bind="ctrl-t:+reload(${launch} --color=always list)" \
    --bind="ctrl-e:execute(${launch} edit {3})" \
    --bind="ctrl-e:+reload(${launch} --color=always list)" \
    --bind="ctrl-r:execute(${launch} $args {3})" \
    --bind="ctrl-r:+reload(${launch} --color=always list)" \
    --bind="ctrl-q:become()" \
    --header='
CTRL-E edit | CTRL-R apply arguments | CTRL-T mark as done
ENTER show task | CTRL-Q quit'
